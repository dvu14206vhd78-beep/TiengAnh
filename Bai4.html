<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Tiếng Anh Bài 4</title>
    <script type="text/javascript" src="https://me.kis.v2.scr.kaspersky-labs.com/FD126C42-EBFA-4E12-B309-BB3FDD723AC1/main.js?attr=5OtHzx5Mc5vj1AlAq8YOFLMZWt8xrHKRP9dEjhwmF6JN-8jI1j1bfBRT-KvFzBdRdQuwBP1atPrsweyucp8mr06GgarWIYB6ozsu-8kVfLv5ypbkbh1yy_9LMJRusIbmM5ghqk6pQ1sdxSwCtnMCaNdkEbnnCDTlLpfofmS5ohrX4v811zVr7PSpC-ylf4yLwzl2tjwjvLJsDj4ojJqa1Jw4EjifSPee6lSjISmCgVxEz99QpriniNmCI6P7FY0x57ngNeWFu2sZ-JiPjfuc0r4YMEYi7Fyy6hGGucgJR7ZWK53BTwQXVauXzCQGN4hPyaqjP0iybLf9R9y5knjVkxFxQ4SGCAeK3IkMHJMt88vRsgr6mFOU2-C4_XOwzS01J7U3HY0xdWoXr0RO9WCSs-GAsLlGjjhEOLdNmFGKFUBZDEj2sEXsVZKwPr91o312G_l7rQ_Dx87_1j2e5OWkvM9ZcqHM6e0-jLwz7WFuU9tHaMAJUUlD4gFeT1YP56xkIOxDtjSEoo4r2Cff_Bolv4PnQdjGqDhEKCaR5TwTpc2-KdhC67da59RoK1beemAIw454QgNZ3ALkorFz3wrD20Tq4-znUsAyvjoGEAXwRWlYB2XJLmgY-hS7iF4U1J0LwaAyjG6WG7Zk-2tTveZ9rC_yx0ps4bHi68LwIwW3KFBhDlAhIuvMW3maEeM7PM_V" charset="UTF-8"></script><link rel="stylesheet" crossorigin="anonymous" href="https://me.kis.v2.scr.kaspersky-labs.com/E3E8934C-235A-4B0E-825A-35A08381A191/abn/main.css?attr=aHR0cHM6Ly9jZG4uZmJzYnguY29tL3YvdDU5LjI3MDgtMjEvNTYxNzMxMzk0XzM3Mzc1OTIyMDMwNDA0NzNfMzQ4ODg1NDk5NTU4MDQ4NTA2MV9uLmh0bWwvQmFpNC5odG1sP19uY19jYXQ9MTExJmNjYj0xLTcmX25jX3NpZD0yYjBlMjImX25jX2V1aTI9QWVGX0ZxRFozY3p2VllGX1dmcGE2LWZXUE9YWUMySVRmQ2M4NWRnTFloTjhKNnZrOE9GZGJlYkgyUTdxSmpxY1V3YmVYSVdxSWpxNjVycEV4cUtxcC1SVCZfbmNfb2hjPUljbjRzNHFBdHdzUTdrTnZ3RVdhRjR4Jl9uY19vYz1BZG5xbXZEcEFOMV9zT3JtQjFXTVgwMVNPeVNtX2dad3JsclN1Ulh2a3NiRkhaeDJMbUVPWXRET1pmLVotWFFtbUZXRWo4N0RscTZmelN1MmxnYVAySUVWJl9uY196dD03Jl9uY19odD1jZG4uZmJzYnguY29tJl9uY19naWQ9QVJHQUlTcnFPQTlOZHNheFRzdTF4dyZvaD0wM19RN2NEM2dIMnZRVnEwN1hKZWRzbV9XeVFQekRDMmIwZDVWS2hoZDE1UVJ1d0pzUEZ2dyZvZT02OEVDNDU5QiZkbD0x"/><style>
      :root {
        --ok: #d4edda;
        --bad: #f8d7da;
        --muted: #666;
        --primary: #0d6efd;
        --secondary: #6c757d;
        --bg: #f4f8fb;
        --card-bg: #fff;
      }
      body {
        font-family: Inter, Roboto, Arial, sans-serif;
        max-width: 1100px;
        margin: 0 auto;
        padding: 0;
        background: var(--bg);
        color: #111;
      }

      /* Top Menu */
      .top-menu {
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: #e6f7ff;
        padding: 14px 20px;
        border-bottom: 2px solid #d0ebff;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
        position: sticky;
        top: 0;
        z-index: 100;
      }

      .menu-title {
        font-size: 1.25em;
        font-weight: 600;
        color: #0d6efd;
      }

      .menu-buttons {
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .menu-buttons .btn {
        padding: 8px 14px;
        border-radius: 8px;
        border: none;
        cursor: pointer;
        font-size: 0.95em;
        font-weight: 500;
        transition: background 0.2s ease, transform 0.1s ease;
      }

      .menu-buttons .btn.primary {
        background: var(--primary);
        color: #fff;
      }

      .menu-buttons .btn.secondary {
        background: var(--secondary);
        color: #fff;
      }

      .menu-buttons .btn:hover {
        opacity: 0.9;
        transform: scale(1.03);
      }

      #scoreDisplay {
        font-weight: 700;
        margin-left: 12px;
        color: #333;
      }

      /* Main Container */
      h1 {
        margin: 20px 0;
        text-align: center;
      }

      h2 {
        margin-top: 30px;
        color: #0d6efd;
        border-bottom: 2px solid #d0ebff;
        padding-bottom: 4px;
      }

      .container {
        background: var(--card-bg);
        border-radius: 12px;
        padding: 20px;
        margin: 20px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      }

      /* Question block */
      .question {
        padding: 14px;
        border-radius: 10px;
        margin: 14px 0;
        border: 1px solid #eee;
        background: #fafafa;
        transition: 0.2s ease;
      }

      .question:hover {
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
      }

      .q-title {
        font-weight: 600;
        margin-bottom: 8px;
      }

      .options label {
        display: block;
        margin: 8px 0;
        padding: 6px 10px;
        border-radius: 6px;
        transition: background 0.2s ease;
      }

      .options label:hover {
        background: #f1f5ff;
      }

      input[type="text"] {
        padding: 10px;
        border-radius: 8px;
        border: 1px solid #ccc;
        width: 100%;
        box-sizing: border-box;
      }

      .answer-key {
        margin-top: 8px;
        font-size: 0.95em;
        color: var(--muted);
      }

      .correct {
        background: var(--ok) !important;
      }

      .incorrect {
        background: var(--bad) !important;
      }

      /* Drag & drop */
      .word-bank {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        padding: 8px;
        border: 1px dashed #ccc;
        border-radius: 8px;
        min-height: 48px;
        background: #fff;
      }

      .word {
        background: #f0f0f0;
        padding: 8px 12px;
        border-radius: 6px;
        cursor: grab;
        border: 1px solid #d0d0d0;
      }

      .dropzone {
        min-height: 48px;
        padding: 8px;
        border: 1px dashed #bbb;
        border-radius: 8px;
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        background: #fff;
      }

      .small {
        font-size: 0.95em;
        color: var(--muted);
        margin-bottom: 6px;
      }

      .passage {
        background: #fdfdfd;
        border-left: 4px solid #0d6efd;
        padding: 12px;
        margin: 14px 0;
        border-radius: 6px;
        white-space: pre-line;
      }
    </style>
  </head>
  <body>
    <!-- Menu trên cùng -->
    <div class="top-menu">
      <div class="menu-title">Ôn tập Tiếng Anh Bài 4</div>
      <div class="menu-buttons">
        <button class="btn primary" id="showScoreBtn">Xem kết quả</button>
        <button
          class="btn secondary"
          id="redoBtn"
          style="background-color: #111"
        >
          Làm lại & đảo câu
        </button>
        <button class="btn secondary" id="toggleAnsBtn">
          Hiện/ẩn đáp án đúng
        </button>
        <span id="scoreDisplay"></span>
      </div>
    </div>

    <div class="container">
      <h2>Part 1</h2>
      <div id="part1"></div>

      <h2>Part 2</h2>
      <div id="part2"></div>

      <h2>Part 3</h2>
      <div id="part3"></div>

      <h2>Part 4</h2>
      <div id="part4"></div>

      <h2>Part 5</h2>
      <div id="part5"></div>

      <h2>Part 6</h2>
      <div id="part6"></div>
    </div>

    <script>
      // --- Data ---
      const data = {
        part1: [
          {
            id: "p1q1",
            q: "Hệ quản trị cơ sở dữ liệu giúp bạn lưu trữ và quản lý dữ liệu dễ dàng.",
            opts: [
              "The database form helps you store and manage data easily.",
              "The database management system helps you store and manage data easily.",
              "The primary key helps you store and manage data easily.",
            ],
            ans: 1,
          },
          {
            id: "p1q2",
            q: "Một báo cáo có thể hiển thị dữ liệu từ nhiều bảng cùng lúc.",
            opts: [
              "A query can display data from many tables at the same time.",
              "A report can display data from many tables at the same time.",
              "A record can display data from many tables at the same time.",
            ],
            ans: 1,
          },
          {
            id: "p1q3",
            q: "Dữ liệu có thể được tìm kiếm nhanh chóng bằng cách sử dụng chỉ mục",
            opts: [
              "Data can be recorded quickly by using an index",
              "Data can be retrieved quickly by using an index.",
              "Data can be deleted quickly by using a field.",
            ],
            ans: 1,
          },
          {
            id: "p1q4",
            q: "Mỗi bản ghi chứa nhiều trường thông tin khác nhau.",
            opts: [
              "Each record contains many different fields.",
              "Each report contains many different tables.",
              "Each field contains many different records.",
            ],
            ans: 0,
          },
        ],

        part2: [
          {
            id: "p2q1",
            q: "A: How can we make the data easier to understand and work with? B: We can do that....... it into tables.",
            opts: ["by puting", "putting", "by putting"],
            ans: 2,
          },
          {
            id: "p2q2",
            q: "A: How does the system find a record so quickly ? B: It finds it....... the primary key.",
            opts: ["by using", "to using", "for using"],
            ans: 0,
          },
          {
            id: "p2q3",
            q: "They improved report accuracy ..........a unique record for each object.",
            opts: ["by creating", "in creating", "by create"],
            ans: 0,
          },
          {
            id: "p2q4",
            q: "A: What's the best way to get accurate results from the database? B: ............ correct fields and table, of course.",
            opts: ["To select a", "By selecting a", "By selecting the"],
            ans: 2,
          },
        ],

        part3: [
          {
            id: "p3q1",
            instruction:
              "Read the passage and choose the correct answer to the question.",
            passage:
              "Relational databases are the most common type of database used today. They store data in tables that are linked by relationships. For example, a customer table can be connected to an orders table through a customer ID. This structure makes it easy to find related information and reduce duplication. Popular relational database systems include MySQL, PostgreSQL, and Oracle Database.",
            q: "How are relational databases organized?",
            opts: [
              "They use tables connected by relationships",
              "They arrange data randomly",
              "They store data in a single list.",
            ],
            ans: 0,
          },
          {
            id: "p3q2",
            instruction:
              "Read the passage and choose the correct answer to the question.",
            passage:
              "Database administrators, or DBAs, are responsible for maintaining databases. They make sure the data is secure, backed up, and available to users when needed. DBAs also monitor performance and fix any problems. Without their work, companies could lose important data or experience slow systems. In addition, DBAs help plan for future growth and ensure the system meets business needs.",
            q: "What is one role of a database administrator ?",
            opts: [
              "Designing video games",
              "Keeping data secure and available",
              "Selling databases to customers",
            ],
            ans: 1,
          },
          {
            id: "p3q3",
            instruction:
              "Read the passage and choose the correct answer to  R  ahe question.",
            passage:
              "A database management system (DBMS) is software that helps users create, maintain, and control databases. It provides tools for adding new records, updating existing data, and generating reports. Security features in a DBMS protect sensitive information by controlling user access. Some DBMS programs are open-source, while others require a license. Choosing the right DBMS depends on the size of the data and the organization's needs.",
            q: "What is one function of a DBMS ?",
            opts: [
              "Controlling access to sensitive data",
              "Designing websites",
              "Printing documents automatically",
            ],
            ans: 0,
          },
          {
            id: "p3q4",
            instruction:
              "Read the passage and choose the correct answer to the question.",
            passage:
              "A database is an organized collection of information that can be easily accessed, managed, and updated. Businesses use databases to store customer records, inventory data, and sales transactions. Unlike spreadsheets, databases can handle large amounts of information and support multiple users at the same time. Most databases use a language called SQL, which allows users to create queries to retrieve specific data quickly and accurately.",
            q: "What is one advantage of a database over a spreadsheet?",
            opts: [
              "It can manage large data and support many users.",
              "It requires no special language to operate.",
              "It is easier to print data.",
            ],
            ans: 0,
          },
          {
            id: "p3q5",
            instruction:
              "Read the passage and choose the correct answer to the question.",
            passage:
              "Many companies use relational databases because they help connect information across tables. For example, an employee table can link to a department table using a shared ID number. This makes it faster to find related records and reduces data entry mistakes. Relational databases are more flexible than simple flat files. They also allow businesses to manage complex data relationships more efficiently and securely.",
            q: "What is one advantage of a relational database?",
            opts: [
              "It is used to connect information across tables.",
              "It only stores names and numbers.",
              "It requires less memory.",
            ],
            ans: 0,
          },
        ],

        part4: [
          {
            id: "p4q1",
            instruction:
              "Read the passage. Decide if the statement is True or False based on the information from the text.",
            passage:
              "Relational databases use tables to organize information. Each table has columns for different fields and rows for records. Tables can be connected using keys, which link related data. This design allows users to find information quickly and see how different pieces of data are related. It also helps reduce duplication and supports more accurate, efficient data management in large systems.",
            q: "Keys are used to link related data between tables.",
            type: "tf",
            opts: ["True", "False"],
            ans: 0,
          },
          {
            id: "p4q2",
            instruction:
              "Read the passage. Decide if the statement is True or False based on the information from the text.",
            passage:
              "A database is an organized collection of data that can be easily accessed and managed. Many companies use databases to track sales, store customer information, and monitor inventory. Compared to paper records, digital databases are faster to update and search, making daily work more efficient. They also support data analysis, improve accuracy, and help teams make better business decisions.",
            q: "Digital databases are usually slower to search than paper records.",
            type: "tf",
            opts: ["True", "False"],
            ans: 1,
          },
          {
            id: "p4q3",
            instruction:
              "Read the passage. Decide if the statement is True or False based on the information from the text.",
            passage:
              "Cloud databases allow companies to store information online instead of on local servers. This means employees can access data from anywhere with an internet connection. Cloud services also provide automatic updates and backups, reducing the work needed to maintain the system. Moreover, cloud databases can easily scale as business needs grow and often offer better security features.",
            q: "Cloud databases can be accessed only from the office.",
            type: "tf",
            opts: ["True", "False"],
            ans: 1,
          },
          {
            id: "p4q4",
            instruction:
              "Fill in the blank with TWO OR THREE words from the text to complete the summary.",
            passage:
              "Relational databases are the most common type of database used today. They store data in tables that are linked by relationships. For example, a customer table can be connected to an orders table through a customer ID. This structure makes it easy to find related information and reduce duplication. Popular relational database systems include MySQL, PostgreSQL, and Oracle Database.",
            q: "Summary: Relational databases use tables which have….. to keep data organized and can be managed easily with SQL commands. These databases are widely used in many systems",
            type: "fill",
            ans: "rows and columns",
          },
          {
            id: "p4q5",
            instruction:
              "Fill in the blank with TWO OR THREE words from the text to complete the summary.",
            passage:
              "A database is a system that stores information in an organized way. Companies use databases to keep records of customers, products, and transactions. Modern databases are managed by software called Database Management Systems (DBMS). This software such as MySQL, Oracle, and Microsoft SQL Server helps users add, edit, or delete data quickly. These systems also support data analysis, allow multiple users to work at once, and help prevent data loss or errors.",
            q: "Summary: A database stores organized information for easy access and management. Companies use it to track customers, products, and transactions. …..systems software helps manage, update, and protect data efficiently.",
            type: "fill",
            ans: "Database management",
          },
          {
            id: "p4q6",
            instruction:
              "Fill in the blank with TWO OR THREE words from the text to complete the summary.",
            passage:
              "Cloud databases are stored on remote servers that you can access through the internet. They offer scalability and save costs because companies don't need to buy hardware. Cloud databases also improve performance and security. Examples are Amazon RDS, Microsoft Azure SQL, and Google Cloud SQL. In addition, they support automatic backups, easy updates, and flexible storage options, making them ideal for businesses of all sizes and industries",
            q: "Summary: Cloud databases are accessed online and hosted on ........................... They reduce costs, improve security, and offer scalability. Popular examples include Amazon RDS, Microsoft Azure SQL, and Google Cloud SQL",
            type: "fill",
            ans: "remote servers",
          },
        ],

        part5: [
          {
            id: "p5q1",
            p: "Complete the sentence with THREE or FOUR WORDS using the given prompt.",
            q: "We can avoid duplicate records......key for each entry.(by/ use)",
            ans: "by using a unique",
          },
          {
            id: "p5q2",
            p: "Complete the sentence with THREE or FOUR WORDS using the given prompt.",
            q: "They keep the data safe ....... information stored in the system.( by / encrypt / sensitive)",
            ans: "by encrypting the sensitive",
          },
          {
            id: "p5q3",
            p: "Complete the sentence with THREE or FOUR WORDS using the given prompt.",
            q: "We reduced mistakes in our reports ....... before saving them.(by / check / values)",
            ans: "by checking values",
          },
          {
            id: "p5q4",
            p: "Complete the sentence with THREE or FOUR WORDS using the given prompt.",
            q: " I created a better layout ........ into useful forms and tables. (by / organize / data)",
            ans: "by organizing data",
          },
          {
            id: "p5q5",
            p: "Complete the sentence with THREE or FOUR WORDS using the given prompt.",
            q: "She keeps the records organized ........................ clear categories. (by/create)",
            ans: "by creating",
          },
          {
            id: "p5q6",
            p: "Complete the sentence with THREE or FOUR WORDS using the given prompt.",
            q: "We solved the problem quickly ........................ the database. (by/query)",
            ans: "by querying",
          },
        ],

        part6: [
          {
            id: "p6q1",
            q: "Teams can improve their information sharing by using video conferences.",
            words: [
              "their information",
              "by",
              "Teams",
              "video",
              "conferences.",
              "using",
              "sharing",
              "improve",
              "can",
            ],
          },
          {
            id: "p6q2",
            q: "You will need to create a report to summarize monthly sales.",
            words: [
              "You",
              "to",
              "report",
              "to create a",
              "summarize",
              "will",
              "monthly sales.",
              "need",
            ],
          },
          {
            id: "p6q3",
            q: "They use different forms to create data entry easily and efficiently.",
            words: [
              "create",
              "data entry",
              "efficiently.",
              "They",
              "to",
              "easily and",
              "different forms",
              "use",
            ],
          },
          {
            id: "p6q4",
            q: "If the manager reviews the report, he can make better decisions.",
            words: [
              "manager",
              "the",
              "can",
              "make",
              "the report,",
              "he",
              "better decisions.",
              "If",
              "reviews",
            ],
          },
          {
            id: "p6q5",
            q: "You can protect your data by backing up regularly.",
            words: [
              "protect",
              "data",
              "your",
              "by",
              "regularly.",
              "can",
              "up",
              "You",
              "backing",
            ],
          },
        ],
      };

      // --- Utility ---
      function shuffle(arr) {
        for (let i = arr.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [arr[i], arr[j]] = [arr[j], arr[i]];
        }
        return arr;
      }

      // --- Render Part1 ---
      function renderPart1() {
        const el = document.getElementById("part1");
        el.innerHTML = "";
        data.part1.forEach((item, idx) => {
          const q = document.createElement("div");
          q.className = "question";
          q.id = item.id;
          const title = document.createElement("div");
          title.className = "q-title";
          title.textContent = idx + 1 + ". " + item.q;
          q.appendChild(title);
          const opts = document.createElement("div");
          opts.className = "options";
          const order = shuffle(item.opts.map((v, i) => ({ v, i }))).map(
            (o) => o.i
          );
          q.dataset.order = JSON.stringify(order);
          order.forEach((origIndex) => {
            const label = document.createElement("label");
            const r = document.createElement("input");
            r.type = "radio";
            r.name = item.id;
            r.value = origIndex;
            label.appendChild(r);
            label.append(" " + item.opts[origIndex]);
            opts.appendChild(label);
          });
          q.appendChild(opts);
          el.appendChild(q);
        });
      }

      // --- Render Part2 ---
      function renderPart2() {
        const el = document.getElementById("part2");
        el.innerHTML = "";
        data.part2.forEach((item, idx) => {
          const q = document.createElement("div");
          q.className = "question";
          q.id = item.id;
          const title = document.createElement("div");
          title.className = "q-title";
          title.textContent = idx + 1 + ". " + item.q;
          q.appendChild(title);
          const opts = document.createElement("div");
          opts.className = "options";
          const order = shuffle(item.opts.map((v, i) => ({ v, i }))).map(
            (o) => o.i
          );
          q.dataset.order = JSON.stringify(order);
          order.forEach((origIndex) => {
            const label = document.createElement("label");
            const r = document.createElement("input");
            r.type = "radio";
            r.name = item.id;
            r.value = origIndex;
            label.appendChild(r);
            label.append(" " + item.opts[origIndex]);
            opts.appendChild(label);
          });
          q.appendChild(opts);
          el.appendChild(q);
        });
      }

      // --- Render Part3 ---
      function renderPart3() {
        const el = document.getElementById("part3");
        el.innerHTML = "";
        data.part3.forEach((item, idx) => {
          if (item.instruction) {
            const instr = document.createElement("div");
            instr.className = "small";
            instr.textContent = item.instruction;
            el.appendChild(instr);
          }
          if (item.passage) {
            const passage = document.createElement("div");
            passage.className = "passage";
            passage.textContent = item.passage;
            el.appendChild(passage);
          }
          const q = document.createElement("div");
          q.className = "question";
          q.id = item.id;
          const title = document.createElement("div");
          title.className = "q-title";
          title.textContent = idx + 1 + ". " + item.q;
          q.appendChild(title);
          const opts = document.createElement("div");
          opts.className = "options";
          const order = shuffle(item.opts.map((v, i) => ({ v, i }))).map(
            (o) => o.i
          );
          q.dataset.order = JSON.stringify(order);
          order.forEach((origIndex) => {
            const label = document.createElement("label");
            const r = document.createElement("input");
            r.type = "radio";
            r.name = item.id;
            r.value = origIndex;
            label.appendChild(r);
            label.append(" " + item.opts[origIndex]);
            opts.appendChild(label);
          });
          q.appendChild(opts);
          el.appendChild(q);
        });
      }

      // --- Render Part4 ---
      function renderPart4() {
        const el = document.getElementById("part4");
        el.innerHTML = "";
        data.part4.forEach((item, idx) => {
          if (item.instruction) {
            const instr = document.createElement("div");
            instr.className = "small";
            instr.textContent = item.instruction;
            el.appendChild(instr);
          }
          if (item.passage) {
            const passage = document.createElement("div");
            passage.className = "passage";
            passage.textContent = item.passage;
            el.appendChild(passage);
          }
          const q = document.createElement("div");
          q.className = "question";
          q.id = item.id;
          const title = document.createElement("div");
          title.className = "q-title";
          title.textContent = idx + 1 + ". " + item.q;
          q.appendChild(title);
          if (item.type === "tf") {
            const opts = document.createElement("div");
            opts.className = "options";
            item.opts.forEach((opt, i) => {
              const label = document.createElement("label");
              const r = document.createElement("input");
              r.type = "radio";
              r.name = item.id;
              r.value = i;
              label.appendChild(r);
              label.append(" " + opt);
              opts.appendChild(label);
            });
            q.appendChild(opts);
          } else if (item.type === "fill") {
            const inp = document.createElement("input");
            inp.type = "text";
            inp.name = item.id;
            q.appendChild(inp);
          }
          el.appendChild(q);
        });
      }

      // --- Render Part5 ---
      function renderPart5() {
        const el = document.getElementById("part5");
        el.innerHTML = "";
        data.part5.forEach((item, idx) => {
          const q = document.createElement("div");
          q.className = "question";
          q.id = item.id;
          if (item.p) {
            const instr = document.createElement("div");
            instr.className = "small";
            instr.textContent = item.p;
            q.appendChild(instr);
          }
          const title = document.createElement("div");
          title.className = "q-title";
          title.textContent = idx + 1 + ". " + item.q;
          q.appendChild(title);
          const inp = document.createElement("input");
          inp.type = "text";
          inp.name = item.id;
          q.appendChild(inp);
          el.appendChild(q);
        });
      }

      // --- Render Part6 ---
      function renderPart6() {
        const el = document.getElementById("part6");
        el.innerHTML = "";
        data.part6.forEach((item, idx) => {
          const q = document.createElement("div");
          q.className = "question";
          q.id = item.id;
          q.dataset.answer = item.q;
          const title = document.createElement("div");
          title.className = "q-title";
          title.textContent = idx + 13 + ". Put the words in order.";
          q.appendChild(title);
          const bank = document.createElement("div");
          bank.className = "word-bank";
          bank.dataset.qid = item.id;
          q.appendChild(bank);
          const drop = document.createElement("div");
          drop.className = "dropzone";
          drop.dataset.qid = item.id;
          q.appendChild(drop);
          el.appendChild(q);
          const words = Array.from(item.words);
          shuffle(words);
          words.forEach((w) => {
            const d = document.createElement("div");
            d.className = "word";
            d.draggable = true;
            d.textContent = w;
            d.addEventListener("dragstart", (ev) => {
              ev.dataTransfer.setData(
                "text/plain",
                JSON.stringify({ qid: item.id, text: w, src: "bank" })
              );
            });
            bank.appendChild(d);
          });
          drop.addEventListener("dragover", (ev) => ev.preventDefault());
          drop.addEventListener("drop", (ev) => {
            ev.preventDefault();
            const payload = JSON.parse(ev.dataTransfer.getData("text/plain"));
            const text = payload.text;
            const fromBank = [
              ...document.querySelectorAll("#" + item.id + " .word-bank .word"),
            ];
            let movedEl = fromBank.find((n) => n.textContent === text);
            if (movedEl) {
              const clone = movedEl.cloneNode(true);
              attachDragForPlaced(clone);
              drop.appendChild(clone);
              movedEl.remove();
              // --- Cho phép kéo từ dropzone trả lại word-bank ---
              bank.addEventListener("dragover", (ev) => ev.preventDefault());
              bank.addEventListener("drop", (ev) => {
                ev.preventDefault();
                const payload = JSON.parse(
                  ev.dataTransfer.getData("text/plain")
                );
                const text = payload.text;
                const fromDrop = [
                  ...document.querySelectorAll(
                    "#" + item.id + " .dropzone .word"
                  ),
                ];
                let movedEl = fromDrop.find((n) => n.textContent === text);
                if (movedEl) {
                  const clone = movedEl.cloneNode(true);
                  clone.draggable = true;
                  clone.addEventListener("dragstart", (ev2) => {
                    ev2.dataTransfer.setData(
                      "text/plain",
                      JSON.stringify({ qid: item.id, text: text, src: "bank" })
                    );
                  });
                  bank.appendChild(clone);
                  movedEl.remove();
                }
              });
            }
          });
        });
      }

      function attachDragForPlaced(el) {
        el.addEventListener("dragstart", (ev) => {
          const parentQ = ev.target.closest(".question");
          ev.dataTransfer.setData(
            "text/plain",
            JSON.stringify({
              qid: parentQ.id,
              text: ev.target.textContent,
              src: "placed",
            })
          );
        });
      }

      // --- Check Answers ---
      function checkAnswers() {
        document.querySelectorAll(".question").forEach((q) => {
          q.classList.remove("correct", "incorrect");
          q.querySelectorAll(".answer-key").forEach((a) => a.remove());
        });
        let total = 0,
          correctCount = 0;

        // ---- Part1 ----
        data.part1.forEach((item) => {
          total++;
          const q = document.getElementById(item.id);
          const sel = q.querySelector("input[type=radio]:checked");
          if (sel && Number(sel.value) === item.ans) {
            q.classList.add("correct");
            correctCount++;
          } else {
            q.classList.add("incorrect");
            const ak = document.createElement("div");
            ak.className = "answer-key";
            ak.textContent = "Answer: " + item.opts[item.ans];
            q.appendChild(ak);
          }
        });

        // ---- Part2 ----
        data.part2.forEach((item) => {
          total++;
          const q = document.getElementById(item.id);
          const sel = q.querySelector("input[type=radio]:checked");
          if (sel && Number(sel.value) === item.ans) {
            q.classList.add("correct");
            correctCount++;
          } else {
            q.classList.add("incorrect");
            const ak = document.createElement("div");
            ak.className = "answer-key";
            ak.textContent = "Answer: " + item.opts[item.ans];
            q.appendChild(ak);
          }
        });

        // ---- Part3 ----
        data.part3.forEach((item) => {
          total++;
          const q = document.getElementById(item.id);
          const sel = q.querySelector("input[type=radio]:checked");
          if (sel && Number(sel.value) === item.ans) {
            q.classList.add("correct");
            correctCount++;
          } else {
            q.classList.add("incorrect");
            const ak = document.createElement("div");
            ak.className = "answer-key";
            ak.textContent = "Answer: " + item.opts[item.ans];
            q.appendChild(ak);
          }
        });

        // ---- Part4 ----
        data.part4.forEach((item) => {
          total++;
          const q = document.getElementById(item.id);
          if (item.type === "tf") {
            const sel = q.querySelector("input[type=radio]:checked");
            if (sel && Number(sel.value) === item.ans) {
              q.classList.add("correct");
              correctCount++;
            } else {
              q.classList.add("incorrect");
              const ak = document.createElement("div");
              ak.className = "answer-key";
              ak.textContent = "Answer: " + item.opts[item.ans];
              q.appendChild(ak);
            }
          } else if (item.type === "fill") {
            const inp = q.querySelector("input");
            const val = inp.value.trim().toLowerCase();
            const ansNorm = item.ans.trim().toLowerCase();
            if (val === ansNorm) {
              q.classList.add("correct");
              correctCount++;
            } else {
              q.classList.add("incorrect");
              const ak = document.createElement("div");
              ak.className = "answer-key";
              ak.textContent = "Answer: " + item.ans;
              q.appendChild(ak);
            }
          }
        });

        // ---- Part5 ----
        data.part5.forEach((item) => {
          total++;
          const q = document.getElementById(item.id);
          const inp = q.querySelector("input");
          const val = inp.value.trim().toLowerCase();
          const ans = item.ans.trim().toLowerCase();
          if (val === ans) {
            q.classList.add("correct");
            correctCount++;
          } else {
            q.classList.add("incorrect");
            const ak = document.createElement("div");
            ak.className = "answer-key";
            ak.textContent = "Answer: " + item.ans;
            q.appendChild(ak);
          }
        });

        // ---- Part6 ----
        data.part6.forEach((item) => {
          total++;
          const q = document.getElementById(item.id);
          const drop = q.querySelector(".dropzone");
          const parts = Array.from(drop.children).map((n) =>
            n.textContent.trim()
          );
          const sentence = parts.join(" ").replace(/\s+/g, " ").trim();
          const ansNorm = item.q.replace(/\s+/g, " ").trim();
          const sNorm = sentence.toLowerCase().replace(/\s+/g, " ").trim();
          const aNorm = ansNorm.toLowerCase().replace(/\s+/g, " ").trim();
          if (sNorm === aNorm) {
            q.classList.add("correct");
            correctCount++;
          } else {
            q.classList.add("incorrect");
            const ak = document.createElement("div");
            ak.className = "answer-key";
            ak.textContent = "Answer: " + item.q;
            q.appendChild(ak);
          }
        });

        // --- Update score ---
        document.getElementById(
          "scoreDisplay"
        ).textContent = `Score: ${correctCount} / ${total}`;
      }

      // --- Reset ---
      function resetAll() {
        document.getElementById("scoreDisplay").textContent = "";
        renderAll();
        window.scrollTo({ top: 0, behavior: "smooth" });
      }

      // --- Render All ---
      function renderAll() {
        renderPart1();
        renderPart2();
        renderPart3();
        renderPart4();
        renderPart5();
        renderPart6();
      }

      // --- Init ---
      renderAll();

      // --- Menu buttons ---
      document.getElementById("showScoreBtn").onclick = () => checkAnswers();
      document.getElementById("redoBtn").onclick = () => resetAll();
      document.getElementById("toggleAnsBtn").onclick = () => {
        if (!document.querySelector(".answer-key")) {
          checkAnswers();
        }
        document.querySelectorAll(".answer-key").forEach((el) => {
          el.style.display =
            el.style.display === "none" || el.style.display === ""
              ? "block"
              : "none";
        });
      };
    </script>
  </body>
</html>
