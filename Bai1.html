<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Tiếng Anh Bài 1</title>
    <script type="text/javascript" src="https://me.kis.v2.scr.kaspersky-labs.com/FD126C42-EBFA-4E12-B309-BB3FDD723AC1/main.js?attr=gQecl0Qn6gJygBHh6C1EDq2xienRoLhL4KIVyjrrdn-hQWHf37u-9zydTeQakJ3_nEtfgPCUa6b34Ir51RYwTezlKdJGT3nVz7HiamJ6-tZVxTVaLrYa6IP8weN7ngTo0H9U-aJh9kIPE2JJcC_cns_vphpcYAMbl_GqkWrRzl-RBUSvklCXQRmGvI-Uu_006jHKkc-N0FPnNRmwCJxp6BVJfgz1sQOBWJMwiVgeSGeeG3_R3P_Okn9n4zR5n9v2Z_hLnYgWr3UT8-CV_Kya_SX6SK49emUoeXSr3IcfknGJMKJS7wvz3b95KcQVWmZ5xu8Y6BtX5WgNECpG27nKpaU8aTldpbhGzNB56KtUEbu_siYLGOGmzQ2_ZBFxVMMGMsE4P-zAsm2epwMJOmi8htWyxZxpgfv20hlIqx847mItvVtuPmEOcy7lToeYsBebPQiRGQFhopjV2JEDbeR40gehj5j06J0HLuo2ZHW40zz39A-aJuAhtcs9lxu9CFBgcdHhsP9h5K9KZfFUcfep-9DaW84nsZaxrQgOa6us-aPWcSg_LPWrnNTgX37WZ3eKDO-FXfLb-XorfXptEPpFDu1AHVDvTaCE745f4wseuuJP_H9kwCskQ2MqjfB28mJoXkCkR1NWEviVjQ4y5OdQsLNEJrDUXycAIl3FKywy_GppM3Q5b1wTy2gYFsxMM43D" charset="UTF-8"></script><link rel="stylesheet" crossorigin="anonymous" href="https://me.kis.v2.scr.kaspersky-labs.com/E3E8934C-235A-4B0E-825A-35A08381A191/abn/main.css?attr=aHR0cHM6Ly9jZG4uZmJzYnguY29tL3YvdDU5LjI3MDgtMjEvNTYzMzg1NjI2XzEzMjQxODA4MzI1NTI4MjJfNTgwNTY1MzY3NDAzODI4NDk4Nl9uLmh0bWwvQmFpMS5odG1sP19uY19jYXQ9MTAwJmNjYj0xLTcmX25jX3NpZD0yYjBlMjImX25jX2V1aTI9QWVIZGhFTXg0akRCM3FKWTNEYkJjVDRQbHlINmw5RFQxUm1YSWZxWDBOUFZHVUdiWDBLQjFZUmVabkJ1cG55V2d1eER0ekdEMDcwR2hNWHhnaDU5bEpJTSZfbmNfb2hjPUlmX3VPVnFPRG4wUTdrTnZ3RWNFQXpyJl9uY19vYz1BZG5OeGc3M01TMHF4cjB5b3ZvVk9VSVFiNGhiaFd0bWlqWWZMVGNLS2MtNjNDZS1sV3FmZWI5U0xhOHg2NWUzZC1hay11Z184d0xHbWpzUFZFWTluNkJaJl9uY196dD03Jl9uY19odD1jZG4uZmJzYnguY29tJl9uY19naWQ9QVJHQUlTcnFPQTlOZHNheFRzdTF4dyZvaD0wM19RN2NEM2dGZy1PNklVOW1vOW40aWR3NVNBcHhldm1Ed3RMeW9tbVptQTFERXpta2ZPZyZvZT02OEVDNTE3MCZkbD0x"/><style>
      :root {
        --ok: #d4edda;
        --bad: #f8d7da;
        --muted: #666;
        --primary: #0d6efd;
        --secondary: #6c757d;
        --bg: #f4f8fb;
        --card-bg: #fff;
      }
      body {
        font-family: Inter, Roboto, Arial, sans-serif;
        max-width: 1100px;
        margin: 0 auto;
        padding: 0;
        background: var(--bg);
        color: #111;
      }

      /* Top Menu */
      .top-menu {
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: #e6f7ff;
        padding: 14px 20px;
        border-bottom: 2px solid #d0ebff;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
        position: sticky;
        top: 0;
        z-index: 100;
      }

      .menu-title {
        font-size: 1.25em;
        font-weight: 600;
        color: #0d6efd;
      }

      .menu-buttons {
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .menu-buttons .btn {
        padding: 8px 14px;
        border-radius: 8px;
        border: none;
        cursor: pointer;
        font-size: 0.95em;
        font-weight: 500;
        transition: background 0.2s ease, transform 0.1s ease;
      }

      .menu-buttons .btn.primary {
        background: var(--primary);
        color: #fff;
      }

      .menu-buttons .btn.secondary {
        background: var(--secondary);
        color: #fff;
      }

      .menu-buttons .btn:hover {
        opacity: 0.9;
        transform: scale(1.03);
      }

      #scoreDisplay {
        font-weight: 700;
        margin-left: 12px;
        color: #333;
      }

      /* Main Container */
      h1 {
        margin: 20px 0;
        text-align: center;
      }

      h2 {
        margin-top: 30px;
        color: #0d6efd;
        border-bottom: 2px solid #d0ebff;
        padding-bottom: 4px;
      }

      .container {
        background: var(--card-bg);
        border-radius: 12px;
        padding: 20px;
        margin: 20px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      }

      /* Question block */
      .question {
        padding: 14px;
        border-radius: 10px;
        margin: 14px 0;
        border: 1px solid #eee;
        background: #fafafa;
        transition: 0.2s ease;
      }

      .question:hover {
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
      }

      .q-title {
        font-weight: 600;
        margin-bottom: 8px;
      }

      .options label {
        display: block;
        margin: 8px 0;
        padding: 6px 10px;
        border-radius: 6px;
        transition: background 0.2s ease;
      }

      .options label:hover {
        background: #f1f5ff;
      }

      input[type="text"] {
        padding: 10px;
        border-radius: 8px;
        border: 1px solid #ccc;
        width: 100%;
        box-sizing: border-box;
      }

      .answer-key {
        margin-top: 8px;
        font-size: 0.95em;
        color: var(--muted);
      }

      .correct {
        background: var(--ok) !important;
      }

      .incorrect {
        background: var(--bad) !important;
      }

      /* Drag & drop */
      .word-bank {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        padding: 8px;
        border: 1px dashed #ccc;
        border-radius: 8px;
        min-height: 48px;
        background: #fff;
      }

      .word {
        background: #f0f0f0;
        padding: 8px 12px;
        border-radius: 6px;
        cursor: grab;
        border: 1px solid #d0d0d0;
      }

      .dropzone {
        min-height: 48px;
        padding: 8px;
        border: 1px dashed #bbb;
        border-radius: 8px;
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        background: #fff;
      }

      .small {
        font-size: 0.95em;
        color: var(--muted);
        margin-bottom: 6px;
      }

      .passage {
        background: #fdfdfd;
        border-left: 4px solid #0d6efd;
        padding: 12px;
        margin: 14px 0;
        border-radius: 6px;
        white-space: pre-line;
      }
    </style>
  </head>
  <body>
    <!-- Menu trên cùng -->
    <div class="top-menu">
      <div class="menu-title">Ôn tập Tiếng Anh Bài 1</div>
      <div class="menu-buttons">
        <button class="btn primary" id="showScoreBtn">Xem kết quả</button>
        <button
          class="btn secondary"
          id="redoBtn"
          style="background-color: #111"
        >
          Làm lại & đảo câu
        </button>
        <button class="btn secondary" id="toggleAnsBtn">
          Hiện/ẩn đáp án đúng
        </button>
        <span id="scoreDisplay"></span>
      </div>
    </div>

    <div class="container">
      <h2>Part 1</h2>
      <div id="part1"></div>

      <h2>Part 2</h2>
      <div id="part2"></div>

      <h2>Part 3</h2>
      <div id="part3"></div>

      <h2>Part 4</h2>
      <div id="part4"></div>

      <h2>Part 5</h2>
      <div id="part5"></div>

      <h2>Part 6</h2>
      <div id="part6"></div>
    </div>

    <script>
      // --- Data ---
      const data = {
        part1: [
          {
            id: "p1q1",
            q: "Để mở một tập tin, bạn nên nhấn đúp vào biểu tượng của nó.",
            opts: [
              "To open a file, you should double-click its icon",
              "To close a file, you should right-click its icon",
              "To delete a file, you should double-click its icon",
            ],
            ans: 0,
          },
          {
            id: "p1q2",
            q: "Tớ không thể kết nối với Wi-Fi từ biểu tượng mạng.",
            opts: [
              "I can’t connect to the Wi-Fi from the network icon",
              "I can’t download files from the folder icon",
              "I can’t connect to the printer from the recycle bin",
            ],
            ans: 0,
          },
          {
            id: "p1q3",
            q: "Nếu bạn muốn phóng to cửa sổ, hãy nhấn nút maximize",
            opts: [
              "If you want to minimize a window, press the maximize button",
              "If you want to close a window, press the icon.",
              "If you want to maximize a window, press the maximize button",
            ],
            ans: 2,
          },
          {
            id: "p1q4",
            q: "Tớ không thể mở ứng dụng từ biểu tượng trên màn hình",
            opts: [
              "I can’t delete any apps from the desktop folder.",
              "I can’t open the app from the icon on the desktop.",
              "I can’t open any external hardware drives in the taskbar",
            ],
            ans: 1,
          },
          {
            id: "p1q5",
            q: "Tớ cần thêm RAM để máy tính chạy nhanh hơn.",
            opts: [
              "I need more webcam to make my computer clearer.",
              "I need more hard drive to make my computer slower",
              "I need more RAM to make my computer faster.",
            ],
            ans: 2,
          },
        ],

        part2: [
          {
            id: "p2q1",
            q: "I’m not sure why the installation failed. B:…… your antivirus software and try again. It might block the setup.",
            opts: ["To turn off", "Turns off", "Turn off"],
            ans: 2,
          },
          {
            id: "p2q2",
            q: "The icons on my desktop are too small to read. B:…… the screen resolution in display settings to make them larger.",
            opts: ["Adjust", "Adjusts", "To adjust"],
            ans: 0,
          },
          {
            id: "p2q3",
            q: "….. the icon to open the application",
            opts: ["Double-click", "Double-clicked", "Double-clicking"],
            ans: 0,
          },
          {
            id: "p2q4",
            q: "……………on the 'Start' button to access the system settings menu.",
            opts: ["Click", "Clicks", "Clicked"],
            ans: 0,
          },
        ],

        part3: [
          {
            id: "p3q1",
            instruction:
              "Read the passage and choose the correct answer to the question.",
            passage:
              "Screen resolution refers to the number of pixels on a screen. A higher resolution means sharper images and more detail. Common resolutions are 1366x768 or 1920x1080. When choosing a monitor or adjusting display settings, it is important to consider resolution. A low-resolution screen may make text look shadowy or images unclear. This affects both comfort and productivity, especially during long use",
            q: "What is the effect of a higher screen resolution?",
            opts: [
              "It gives good quality images and more detail",
              "It makes the screen smaller.",
              "It user fewer pixels",
            ],
            ans: 0,
          },
          {
            id: "p3q2",
            instruction:
              "Read the passage and choose the correct answer to the question.",
            passage:
              "Input devices like a mouse and keyboard are essential for using a Graphical User Interface (GUI). A mouse helps move the pointer and select icons. A keyboard is used to enter text and shortcuts. Touchscreens, found in tablets and smartphones, are also input devices that support GUI operations. These tools make it easier for users to work with software.",
            q: "Which is not an input device?",
            opts: ["tables", "touchscreens", "keyboards"],
            ans: 0,
          },
          {
            id: "p3q3",
            instruction:
              "Read the passage and choose the correct answer to the question.",
            passage:
              "RAM stands for Random Access Memory. It is important for system performance. More RAM allows a computer to run multiple programs smoothly. For example, if you open a browser, a music player, and a game at the same time, your computer will perform better if it has enough RAM. Low RAM can make the system very slow or even freeze.",
            q: "What does a computer need to run multiple tasks at a time smoothly ?",
            opts: ["enough RAM", "RAM", "the system performance"],
            ans: 0,
          },
          {
            id: "p3q4",
            instruction:
              "Read the passage and choose the correct answer to the question.",
            passage:
              "Before installing software, users must check the system requirements. These include the operating system, processor speed, RAM, and storage space. If the computer does not meet the minimum requirements, the software may not run properly. Some programs also need a specific type of graphics card or internet connection. Always read the specifications carefully before downloading.",
            q: "Why is it important to check the system requirements before installing software?",
            opts: [
              "To make sure the software is free",
              "To ensure the software works properly on the computer",
              "To choose the best brand of computer",
            ],
            ans: 1,
          },
          {
            id: "p3q5",
            instruction:
              "Read the passage and choose the correct answer to the question.",
            passage:
              "A Graphical User Interface (GUI) uses icons, buttons, and windows that allow users to interact with the computer easily. Unlike a Command Line Interface, a GUI is more user-friendly because users can click and drag items with a mouse. Most operating systems like Windows, macOS, and Linux have GUIs. It helps beginners navigate and operate software without typing commands.",
            q: "What is one main purpose of a GUI?",
            opts: [
              "To help users interact with the computer more easily",
              "To increase processor speed",
              "To install more storage space",
            ],
            ans: 0,
          },
        ],

        part4: [
          {
            id: "p4q1",
            instruction:
              "Read the passage. Decide if the statement is True or False based on the information from the text.",
            passage:
              "When buying a computer, it is important to check the system specifications. These include the processor speed, RAM size, hard drive capacity, and operating system. A faster processor helps the computer run programs quickly. More RAM allows for smoother multitasking. The operating system must support the software you plan to use. If you want to play games or edit videos, you'll need a more powerful system.",
            q: ": The system specifications are only important for playing games.",
            type: "tf",
            opts: ["True", "False"],
            ans: 1,
          },
          {
            id: "p4q2",
            instruction:
              "Read the passage. Decide if the statement is True or False based on the information from the text.",
            passage:
              "A Graphical User Interface (GUI) allows users to interact with a computer using images, icons, and windows. It is easier for beginners than a command-line interface, which requires typing commands. With a GUI, users can click buttons and drag files using a mouse. Most modern operating systems like Windows and macOS use a GUI.",
            q: "GUIs are harder to use than command-line interfaces.",
            type: "tf",
            opts: ["True", "False"],
            ans: 1,
          },

          {
            id: "p4q3",
            instruction:
              "Fill in the blank with TWO OR THREE words from the text to complete the summary.",
            passage:
              "When buying a new computer, it's important to check the system specifications. These details include the processor type, RAM size, storage capacity, and operating system. A fast processor and enough RAM help the computer run smoothly. If you want to play games or edit videos, you will also need a strong graphics card. Knowing the system specifications helps you choose a computer that fits your needs and avoids future problems with slow performance or software issues.",
            q: "Summary: Check system specifications like processor, RAM, storage, OS, and graphics card when buying a computer. These help ____________ and choose the right device for tasks like gaming or video editing.",
            type: "fill",
            ans: "the computer run smoothly",
          },
          {
            id: "p4q4",
            instruction:
              "Fill in the blank with TWO OR THREE words from the text to complete the summary.",
            passage:
              "A Graphical User Interface (GUI) uses icons, buttons, and windows that allow users to interact with the computer easily. Unlike a Command Line Interface, a GUI is more user-friendly because users can click and drag items with a mouse. Most operating systems like Windows, macOS, and Linux have GUIs. It helps beginners navigate and operate software without typing commands.",
            q: "Summary : A GUI uses icons and windows, letting users interact easily by clicking and dragging. It's ____________ than command-lines, helping beginners use software without typing commands.",
            type: "fill",
            ans: "more user-friendly",
          },
          {
            id: "p4q5",
            instruction:
              "Fill in the blank with TWO OR THREE words from the text to complete the summary.",
            passage:
              "A GUI, or Graphical User Interface, makes it easy for users to interact with computers. Instead of typing commands, users can click icons, select items from menus, and drag windows. This visual method is faster and more comfortable for most people, especially beginners. Popular operating systems like Windows and macOS use GUIs to help users access files and applications easily. With a good GUI, users spend less time learning commands and more time working productively",
            q: "Summary: A GUI lets users interact with computers easily by clicking icons and menus, making it……………………for users. It helps people work efficiently without needing to learn commands.",
            type: "fill",
            ans: "faster and more comfortable",
          },
        ],

        part5: [
          {
            id: "p5q1",
            p: "Complete the sentence with THREE or FOUR WORDS using the given prompt.",
            q: " A: The window is too big and covers the screen. B: ____________ the side to make room.(move)",
            ans: "Move it to",
          },
          {
            id: "p5q2",
            p: "Complete the sentence with THREE or FOUR WORDS using the given prompt.",
            q: "A: I'm going to close the file. B: Wait! ____________ first. (save)",
            ans: "Save it",
          },
          {
            id: "p5q3",
            p: "Complete the sentence with THREE or FOUR WORDS using the given prompt.",
            q: "A: This screen looks strange on my monitor. B: ____________ display resolution in the settings. (adjust)",
            ans: "Adjust the",
          },
          {
            id: "p5q4",
            p: "Complete the sentence with THREE or FOUR WORDS using the given prompt.",
            q: "A: I want to open the settings, but I don’t know how to do. \n B: ____________ gear icon on the taskbar. ( click ) ",
            ans: "Click the",
          },
          {
            id: "p5q5",
            p: "Complete the sentence with THREE or FOUR WORDS using the given prompt.",
            q: "A: I’m not sure if this program will run on my laptop.\nB: ____________ system requirements first. ( check )",
            ans: "Check the",
          },
        ],

        part6: [
          {
            id: "p6q1",
            q: "Always check the system specifications carefully before buying a new computer.",
            words: [
              "Always",
              "computer.",
              "check",
              "a new",
              "the system",
              "carefully before",
              "buying",
              "specifications",
            ],
          },
          {
            id: "p6q2",
            q: "To open the file, simply click on the icon in the Graphical User Interface (GUI).",
            words: [
              "click on",
              "in the",
              "the icon",
              "User",
              "the file, simply",
              "Interface (GUI).",
              "To open",
              "Graphical",
            ],
          },
          {
            id: "p6q3",
            q: "Carefully select software that matches your system specifications before installing it.",
            words: [
              "select",
              "Carefully",
              "software",
              "before installing",
              "your system",
              "it.",
              "specifications",
              "that matches",
            ],
          },
          {
            id: "p6q4",
            q: "Keep your system and software updated regularly for better performance.",
            words: [
              "performance.",
              "for better",
              "and software",
              "your system",
              "updated regularly",
              "Keep",
            ],
          },
          {
            id: "p6q5",
            q: "Do not install programs if your system doesn’t meet the requirements.",
            words: [
              "Do not",
              "meet",
              "system doesn't",
              "install",
              "the requirements.",
              "if your",
              "programs",
            ],
          },
        ],
      };

      // --- Utility ---
      function shuffle(arr) {
        for (let i = arr.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [arr[i], arr[j]] = [arr[j], arr[i]];
        }
        return arr;
      }

      // --- Render Part1 ---
      function renderPart1() {
        const el = document.getElementById("part1");
        el.innerHTML = "";
        data.part1.forEach((item, idx) => {
          const q = document.createElement("div");
          q.className = "question";
          q.id = item.id;
          const title = document.createElement("div");
          title.className = "q-title";
          title.textContent = idx + 1 + ". " + item.q;
          q.appendChild(title);
          const opts = document.createElement("div");
          opts.className = "options";
          const order = shuffle(item.opts.map((v, i) => ({ v, i }))).map(
            (o) => o.i
          );
          q.dataset.order = JSON.stringify(order);
          order.forEach((origIndex) => {
            const label = document.createElement("label");
            const r = document.createElement("input");
            r.type = "radio";
            r.name = item.id;
            r.value = origIndex;
            label.appendChild(r);
            label.append(" " + item.opts[origIndex]);
            opts.appendChild(label);
          });
          q.appendChild(opts);
          el.appendChild(q);
        });
      }

      // --- Render Part2 ---
      function renderPart2() {
        const el = document.getElementById("part2");
        el.innerHTML = "";
        data.part2.forEach((item, idx) => {
          const q = document.createElement("div");
          q.className = "question";
          q.id = item.id;
          const title = document.createElement("div");
          title.className = "q-title";
          title.textContent = idx + 1 + ". " + item.q;
          q.appendChild(title);
          const opts = document.createElement("div");
          opts.className = "options";
          const order = shuffle(item.opts.map((v, i) => ({ v, i }))).map(
            (o) => o.i
          );
          q.dataset.order = JSON.stringify(order);
          order.forEach((origIndex) => {
            const label = document.createElement("label");
            const r = document.createElement("input");
            r.type = "radio";
            r.name = item.id;
            r.value = origIndex;
            label.appendChild(r);
            label.append(" " + item.opts[origIndex]);
            opts.appendChild(label);
          });
          q.appendChild(opts);
          el.appendChild(q);
        });
      }

      // --- Render Part3 ---
      function renderPart3() {
        const el = document.getElementById("part3");
        el.innerHTML = "";
        data.part3.forEach((item, idx) => {
          if (item.instruction) {
            const instr = document.createElement("div");
            instr.className = "small";
            instr.textContent = item.instruction;
            el.appendChild(instr);
          }
          if (item.passage) {
            const passage = document.createElement("div");
            passage.className = "passage";
            passage.textContent = item.passage;
            el.appendChild(passage);
          }
          const q = document.createElement("div");
          q.className = "question";
          q.id = item.id;
          const title = document.createElement("div");
          title.className = "q-title";
          title.textContent = idx + 1 + ". " + item.q;
          q.appendChild(title);
          const opts = document.createElement("div");
          opts.className = "options";
          const order = shuffle(item.opts.map((v, i) => ({ v, i }))).map(
            (o) => o.i
          );
          q.dataset.order = JSON.stringify(order);
          order.forEach((origIndex) => {
            const label = document.createElement("label");
            const r = document.createElement("input");
            r.type = "radio";
            r.name = item.id;
            r.value = origIndex;
            label.appendChild(r);
            label.append(" " + item.opts[origIndex]);
            opts.appendChild(label);
          });
          q.appendChild(opts);
          el.appendChild(q);
        });
      }

      // --- Render Part4 ---
      function renderPart4() {
        const el = document.getElementById("part4");
        el.innerHTML = "";
        data.part4.forEach((item, idx) => {
          if (item.instruction) {
            const instr = document.createElement("div");
            instr.className = "small";
            instr.textContent = item.instruction;
            el.appendChild(instr);
          }
          if (item.passage) {
            const passage = document.createElement("div");
            passage.className = "passage";
            passage.textContent = item.passage;
            el.appendChild(passage);
          }
          const q = document.createElement("div");
          q.className = "question";
          q.id = item.id;
          const title = document.createElement("div");
          title.className = "q-title";
          title.textContent = idx + 1 + ". " + item.q;
          q.appendChild(title);
          if (item.type === "tf") {
            const opts = document.createElement("div");
            opts.className = "options";
            item.opts.forEach((opt, i) => {
              const label = document.createElement("label");
              const r = document.createElement("input");
              r.type = "radio";
              r.name = item.id;
              r.value = i;
              label.appendChild(r);
              label.append(" " + opt);
              opts.appendChild(label);
            });
            q.appendChild(opts);
          } else if (item.type === "fill") {
            const inp = document.createElement("input");
            inp.type = "text";
            inp.name = item.id;
            q.appendChild(inp);
          }
          el.appendChild(q);
        });
      }

      // --- Render Part5 ---
      function renderPart5() {
        const el = document.getElementById("part5");
        el.innerHTML = "";
        data.part5.forEach((item, idx) => {
          const q = document.createElement("div");
          q.className = "question";
          q.id = item.id;
          if (item.p) {
            const instr = document.createElement("div");
            instr.className = "small";
            instr.textContent = item.p;
            q.appendChild(instr);
          }
          const title = document.createElement("div");
          title.className = "q-title";
          title.textContent = idx + 1 + ". " + item.q;
          q.appendChild(title);
          const inp = document.createElement("input");
          inp.type = "text";
          inp.name = item.id;
          q.appendChild(inp);
          el.appendChild(q);
        });
      }

      // --- Render Part6 ---
      function renderPart6() {
        const el = document.getElementById("part6");
        el.innerHTML = "";
        data.part6.forEach((item, idx) => {
          const q = document.createElement("div");
          q.className = "question";
          q.id = item.id;
          q.dataset.answer = item.q;
          const title = document.createElement("div");
          title.className = "q-title";
          title.textContent = idx + 13 + ". Put the words in order.";
          q.appendChild(title);
          const bank = document.createElement("div");
          bank.className = "word-bank";
          bank.dataset.qid = item.id;
          q.appendChild(bank);
          const drop = document.createElement("div");
          drop.className = "dropzone";
          drop.dataset.qid = item.id;
          q.appendChild(drop);
          el.appendChild(q);
          const words = Array.from(item.words);
          shuffle(words);
          words.forEach((w) => {
            const d = document.createElement("div");
            d.className = "word";
            d.draggable = true;
            d.textContent = w;
            d.addEventListener("dragstart", (ev) => {
              ev.dataTransfer.setData(
                "text/plain",
                JSON.stringify({ qid: item.id, text: w, src: "bank" })
              );
            });
            bank.appendChild(d);
          });
          drop.addEventListener("dragover", (ev) => ev.preventDefault());
          drop.addEventListener("drop", (ev) => {
            ev.preventDefault();
            const payload = JSON.parse(ev.dataTransfer.getData("text/plain"));
            const text = payload.text;
            const fromBank = [
              ...document.querySelectorAll("#" + item.id + " .word-bank .word"),
            ];
            let movedEl = fromBank.find((n) => n.textContent === text);
            if (movedEl) {
              const clone = movedEl.cloneNode(true);
              attachDragForPlaced(clone);
              drop.appendChild(clone);
              movedEl.remove();
              // --- Cho phép kéo từ dropzone trả lại word-bank ---
              bank.addEventListener("dragover", (ev) => ev.preventDefault());
              bank.addEventListener("drop", (ev) => {
                ev.preventDefault();
                const payload = JSON.parse(
                  ev.dataTransfer.getData("text/plain")
                );
                const text = payload.text;
                const fromDrop = [
                  ...document.querySelectorAll(
                    "#" + item.id + " .dropzone .word"
                  ),
                ];
                let movedEl = fromDrop.find((n) => n.textContent === text);
                if (movedEl) {
                  const clone = movedEl.cloneNode(true);
                  clone.draggable = true;
                  clone.addEventListener("dragstart", (ev2) => {
                    ev2.dataTransfer.setData(
                      "text/plain",
                      JSON.stringify({ qid: item.id, text: text, src: "bank" })
                    );
                  });
                  bank.appendChild(clone);
                  movedEl.remove();
                }
              });
            }
          });
        });
      }

      function attachDragForPlaced(el) {
        el.addEventListener("dragstart", (ev) => {
          const parentQ = ev.target.closest(".question");
          ev.dataTransfer.setData(
            "text/plain",
            JSON.stringify({
              qid: parentQ.id,
              text: ev.target.textContent,
              src: "placed",
            })
          );
        });
      }

      // --- Check Answers ---
      function checkAnswers() {
        document.querySelectorAll(".question").forEach((q) => {
          q.classList.remove("correct", "incorrect");
          q.querySelectorAll(".answer-key").forEach((a) => a.remove());
        });
        let total = 0,
          correctCount = 0;

        // ---- Part1 ----
        data.part1.forEach((item) => {
          total++;
          const q = document.getElementById(item.id);
          const sel = q.querySelector("input[type=radio]:checked");
          if (sel && Number(sel.value) === item.ans) {
            q.classList.add("correct");
            correctCount++;
          } else {
            q.classList.add("incorrect");
            const ak = document.createElement("div");
            ak.className = "answer-key";
            ak.textContent = "Answer: " + item.opts[item.ans];
            q.appendChild(ak);
          }
        });

        // ---- Part2 ----
        data.part2.forEach((item) => {
          total++;
          const q = document.getElementById(item.id);
          const sel = q.querySelector("input[type=radio]:checked");
          if (sel && Number(sel.value) === item.ans) {
            q.classList.add("correct");
            correctCount++;
          } else {
            q.classList.add("incorrect");
            const ak = document.createElement("div");
            ak.className = "answer-key";
            ak.textContent = "Answer: " + item.opts[item.ans];
            q.appendChild(ak);
          }
        });

        // ---- Part3 ----
        data.part3.forEach((item) => {
          total++;
          const q = document.getElementById(item.id);
          const sel = q.querySelector("input[type=radio]:checked");
          if (sel && Number(sel.value) === item.ans) {
            q.classList.add("correct");
            correctCount++;
          } else {
            q.classList.add("incorrect");
            const ak = document.createElement("div");
            ak.className = "answer-key";
            ak.textContent = "Answer: " + item.opts[item.ans];
            q.appendChild(ak);
          }
        });

        // ---- Part4 ----
        data.part4.forEach((item) => {
          total++;
          const q = document.getElementById(item.id);
          if (item.type === "tf") {
            const sel = q.querySelector("input[type=radio]:checked");
            if (sel && Number(sel.value) === item.ans) {
              q.classList.add("correct");
              correctCount++;
            } else {
              q.classList.add("incorrect");
              const ak = document.createElement("div");
              ak.className = "answer-key";
              ak.textContent = "Answer: " + item.opts[item.ans];
              q.appendChild(ak);
            }
          } else if (item.type === "fill") {
            const inp = q.querySelector("input");
            const val = inp.value.trim().toLowerCase();
            const ansNorm = item.ans.trim().toLowerCase();
            if (val === ansNorm) {
              q.classList.add("correct");
              correctCount++;
            } else {
              q.classList.add("incorrect");
              const ak = document.createElement("div");
              ak.className = "answer-key";
              ak.textContent = "Answer: " + item.ans;
              q.appendChild(ak);
            }
          }
        });

        // ---- Part5 ----
        data.part5.forEach((item) => {
          total++;
          const q = document.getElementById(item.id);
          const inp = q.querySelector("input");
          const val = inp.value.trim().toLowerCase();
          const ans = item.ans.trim().toLowerCase();
          if (val === ans) {
            q.classList.add("correct");
            correctCount++;
          } else {
            q.classList.add("incorrect");
            const ak = document.createElement("div");
            ak.className = "answer-key";
            ak.textContent = "Answer: " + item.ans;
            q.appendChild(ak);
          }
        });

        // ---- Part6 ----
        data.part6.forEach((item) => {
          total++;
          const q = document.getElementById(item.id);
          const drop = q.querySelector(".dropzone");
          const parts = Array.from(drop.children).map((n) =>
            n.textContent.trim()
          );
          const sentence = parts.join(" ").replace(/\s+/g, " ").trim();
          const ansNorm = item.q.replace(/\s+/g, " ").trim();
          const sNorm = sentence.toLowerCase().replace(/\s+/g, " ").trim();
          const aNorm = ansNorm.toLowerCase().replace(/\s+/g, " ").trim();
          if (sNorm === aNorm) {
            q.classList.add("correct");
            correctCount++;
          } else {
            q.classList.add("incorrect");
            const ak = document.createElement("div");
            ak.className = "answer-key";
            ak.textContent = "Answer: " + item.q;
            q.appendChild(ak);
          }
        });

        // --- Update score ---
        document.getElementById(
          "scoreDisplay"
        ).textContent = `Score: ${correctCount} / ${total}`;
      }

      // --- Reset ---
      function resetAll() {
        document.getElementById("scoreDisplay").textContent = "";
        renderAll();
        window.scrollTo({ top: 0, behavior: "smooth" });
      }

      // --- Render All ---
      function renderAll() {
        renderPart1();
        renderPart2();
        renderPart3();
        renderPart4();
        renderPart5();
        renderPart6();
      }

      // --- Init ---
      renderAll();

      // --- Menu buttons ---
      document.getElementById("showScoreBtn").onclick = () => checkAnswers();
      document.getElementById("redoBtn").onclick = () => resetAll();
      document.getElementById("toggleAnsBtn").onclick = () => {
        if (!document.querySelector(".answer-key")) {
          checkAnswers();
        }
        document.querySelectorAll(".answer-key").forEach((el) => {
          el.style.display =
            el.style.display === "none" || el.style.display === ""
              ? "block"
              : "none";
        });
      };
    </script>
  </body>
</html>
